<div class="container">
  <h1>注文情報確認</h1>
  
  <div class="row">
    <div class="col">
      <table class="table">
        <tr>
          <th>商品名</th>
          <th>単価（税込）</th>
          <th>数量</th>
          <th>小計</th>
        </tr>
        <%= @cart_items.each do |cart_item| %>
          <tr>
            <td>
              <%= image_tag cart_item.item.image, size: "100x80" %>
              <strong><%= cart_item.item.name %></strong>
            </td>
            <td><%= cart_item.item.price %></td>
            <td><%= cart_item.amount %></td>
            <td><%= cart_item.item.price*cart_item.amount %></td>
          </tr>
        <% end %>
      </table>
    </div>

    <div class="col">
      <table class="table">
        <tr>
          <th>送料</th>
          <td><%= @shipping_fee %></td>
        </tr>
        <tr>
          <th>商品合計</th>
          <td><%= @cart_items_price %></td>
        </tr>
        <tr>
          <th>請求金額</th>
          <td><%= @total_payment %></td>
        </tr>
      </table>
    </div>
  </div>
  
  <h4>支払い方法</h4>
  <% if @selected_pay_method == "credit_card" %>
    クレジットカード
  <% else %>
    銀行振込
  <% end %>
    
  <h4>お届け先</h4>
  <%= @selected_address %>
  <%= form_with url: orders_path, method: :post do %>
    <%= hidden_field_tag 'order[pay_method]', @selected_pay_method %>
    <%= hidden_field_tag 'order[address_type]', @address_type %>
    
    <% if @address_type == "registered_address" %>
      <%= hidden_field_tag 'order[registered_address_id]', params[:order][:registered_address_id] %>
    <% elsif @address_type == "new_address" %>
      <%= hidden_field_tag 'order[new_post_code]', params[:order][:new_post_code] %>
      <%= hidden_field_tag 'order[new_address]', params[:order][:new_address] %>
      <%= hidden_field_tag 'order[new_name]', params[:order][:new_name] %>
    <% end %>
    <%= submit_tag "注文を確定する", class: "btn btn-success" %>
  <% end %>

</div>